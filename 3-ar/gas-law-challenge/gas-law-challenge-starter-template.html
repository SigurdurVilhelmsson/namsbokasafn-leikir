<!DOCTYPE html>
<html lang="is">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gas Law Challenge - Kvenno Efnafr√¶√∞i</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Kvenno Brand Colors */
        :root {
            --kvenno-orange: #f36b22;
            --kvenno-orange-dark: #d95a1a;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: #f9fafb;
        }

        /* Header Styles */
        .site-header {
            background: white;
            border-bottom: 2px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            height: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .site-logo {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--kvenno-orange);
            text-decoration: none;
        }

        .site-logo:hover {
            color: var(--kvenno-orange-dark);
        }

        .header-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }

        .header-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        /* Back Button */
        .back-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 0.875rem;
            margin: 0 1rem 1rem 1rem;
        }

        .back-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        /* Canvas for Particle Animation */
        #gasCanvas {
            border-radius: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Animations */
        @keyframes pulse-success {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse-success {
            animation: pulse-success 0.6s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.4s ease-in-out;
        }

        /* Pressure Indicator Borders */
        .pressure-low {
            border: 2px solid #3b82f6;
        }

        .pressure-normal {
            border: 3px solid #22c55e;
        }

        .pressure-high {
            border: 5px solid #ef4444;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            #gasCanvas {
                max-width: 100%;
                height: auto;
            }
            
            .header-content {
                font-size: 0.875rem;
            }
        }

        /* Loading Animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading {
            border: 3px solid #f3f4f6;
            border-top: 3px solid var(--kvenno-orange);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ============================================
        // CONFIGURATION & CONSTANTS
        // ============================================
        
        const R = 0.08206; // Gas constant in L¬∑atm/(mol¬∑K)
        
        const TRANSLATIONS = {
            practiceMode: "√Üfingarhamur",
            challengeMode: "Keppnishamur",
            score: "Stig",
            streak: "Runa",
            time: "T√≠mi",
            difficulty: "Erfi√∞leikastig",
            checkAnswer: "Athuga svar",
            nextQuestion: "N√¶sta spurning",
            showSolution: "S√Ωna lausn",
            hint: "V√≠sbending",
            tryAgain: "Reyndu aftur",
            correct: "R√©tt! Vel gert!",
            incorrect: "Rangt",
            timeout: "T√≠minn rann √∫t!",
            instructions: "Lei√∞beiningar",
            help: "Hj√°lp",
            back: "Til baka",
            easy: "Au√∞velt",
            medium: "Mi√∞lungs",
            hard: "Erfitt",
        };

        // ============================================
        // PARTICLE SYSTEM FOR GAS VISUALIZATION
        // ============================================
        
        class Particle {
            constructor(x, y, containerWidth, containerHeight) {
                this.x = x;
                this.y = y;
                this.radius = 4;
                this.color = '#ffffff';
                // Random velocity
                this.vx = (Math.random() - 0.5) * 4;
                this.vy = (Math.random() - 0.5) * 4;
            }

            update(containerWidth, containerHeight, temperature) {
                // Speed factor based on temperature (kinetic theory: v ‚àù ‚àöT)
                const speedFactor = Math.sqrt(temperature / 273);
                
                // Update position
                this.x += this.vx * speedFactor;
                this.y += this.vy * speedFactor;

                // Bounce off walls
                if (this.x - this.radius <= 0 || this.x + this.radius >= containerWidth) {
                    this.vx *= -1;
                    this.x = Math.max(this.radius, Math.min(containerWidth - this.radius, this.x));
                }
                
                if (this.y - this.radius <= 0 || this.y + this.radius >= containerHeight) {
                    this.vy *= -1;
                    this.y = Math.max(this.radius, Math.min(containerHeight - this.radius, this.y));
                }
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // Add glow effect
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        // ============================================
        // QUESTION BANK GENERATOR
        // ============================================
        
        const generateQuestions = () => {
            // TODO: Generate 30+ questions across three difficulty levels
            // Mix which variable is unknown (P, V, T, n)
            // Each question should have realistic scenario context
            
            const questions = [];
            
            // Example structure (Claude Code will expand this):
            const exampleQuestion = {
                id: 1,
                difficulty: 'easy',
                scenario: {
                    title: "Afm√¶lisbl√∂√∞ra",
                    titleEn: "Birthday Balloon",
                    icon: "üéà",
                    description: "√û√∫ ert a√∞ bl√°sa upp bl√∂√∞ru fyrir afm√¶lisveislu. Lofti√∞ √≠ andanum √æ√≠num er um 37¬∞C.",
                    descriptionEn: "You're blowing up a balloon for a birthday party. The air from your breath is about 37¬∞C."
                },
                given: {
                    P: { value: 1.0, unit: "atm" },
                    T: { value: 310, unit: "K", displayCelsius: 37 },
                    n: { value: 0.15, unit: "mol" }
                },
                find: "V",
                answer: {
                    value: 3.82,
                    unit: "L",
                    tolerance: 0.08
                }
            };
            
            return questions;
        };

        // ============================================
        // MAIN GAME COMPONENT
        // ============================================
        
        const GasLawChallenge = () => {
            // State management
            const [gameState, setGameState] = useState({
                screen: 'menu', // 'menu', 'playing', 'results'
                mode: null, // 'practice' or 'challenge'
                difficulty: 'easy',
                currentQuestion: null,
                questionNumber: 0,
                score: 0,
                streak: 0,
                hintsUsed: 0,
                hintsRemaining: 3,
                timeRemaining: 90,
                userAnswer: '',
                feedback: null,
                showHint: false,
                hintLevel: 0,
                showSolution: false,
            });

            const canvasRef = useRef(null);
            const particlesRef = useRef([]);
            const animationRef = useRef(null);

            // TODO: Claude Code implements these functions
            
            const startGame = (mode) => {
                // Initialize game
            };

            const loadNextQuestion = () => {
                // Load new question
            };

            const checkAnswer = () => {
                // Validate answer and provide feedback
            };

            const showHint = () => {
                // Display progressive hints
            };

            const calculateAnswer = (question) => {
                // Calculate correct answer using PV = nRT
            };

            // Canvas animation effect
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                const animate = () => {
                    // Clear canvas
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    // Draw particles
                    particlesRef.current.forEach(particle => {
                        particle.update(canvas.width, canvas.height, 
                                      gameState.currentQuestion?.given.T?.value || 273);
                        particle.draw(ctx);
                    });

                    animationRef.current = requestAnimationFrame(animate);
                };

                animate();

                return () => {
                    if (animationRef.current) {
                        cancelAnimationFrame(animationRef.current);
                    }
                };
            }, [gameState.currentQuestion]);

            // Timer effect for Challenge mode
            useEffect(() => {
                if (gameState.mode === 'challenge' && gameState.screen === 'playing' && gameState.timeRemaining > 0) {
                    const timer = setTimeout(() => {
                        setGameState(prev => ({
                            ...prev,
                            timeRemaining: prev.timeRemaining - 1
                        }));
                    }, 1000);

                    return () => clearTimeout(timer);
                }
            }, [gameState.timeRemaining, gameState.mode, gameState.screen]);

            // ============================================
            // RENDER: Menu Screen
            // ============================================
            
            if (gameState.screen === 'menu') {
                return (
                    <div>
                        {/* Header */}
                        <header className="site-header">
                            <div className="header-content">
                                <a href="https://kvenno.app" className="site-logo">Kvenno.app</a>
                                <div>
                                    <button className="header-btn">
                                        {TRANSLATIONS.instructions}
                                    </button>
                                </div>
                            </div>
                        </header>

                        {/* Back Button */}
                        <nav className="nav-container">
                            <a href="https://kvenno.app/games" className="back-btn">
                                ‚Üê {TRANSLATIONS.back}
                            </a>
                        </nav>

                        {/* Menu Content */}
                        <div className="max-w-4xl mx-auto px-4 py-8">
                            <div className="bg-white rounded-2xl shadow-xl p-8 text-center">
                                <h1 className="text-4xl md:text-5xl font-bold mb-4" 
                                    style={{color: 'var(--kvenno-orange)'}}>
                                    Gas Law Challenge
                                </h1>
                                <h2 className="text-2xl text-gray-600 mb-8">
                                    L√∂gm√°li√∞ um lofttegundir
                                </h2>

                                <div className="text-6xl mb-6">üéàüî¨‚öóÔ∏è</div>

                                <p className="text-lg text-gray-700 mb-8 max-w-2xl mx-auto">
                                    √Üf√∞u √æig √≠ a√∞ nota j√∂fnu st√∂√∞ulofttegunda (PV = nRT) me√∞ gagnvirkum 
                                    vandam√°lum. Sj√°√∞u agnir hreyfast √≠ raunt√≠ma!
                                </p>

                                <p className="text-base text-gray-600 mb-8">
                                    Practice using the ideal gas law (PV = nRT) with interactive problems. 
                                    See particles move in real-time!
                                </p>

                                {/* Mode Selection */}
                                <div className="grid md:grid-cols-2 gap-6 max-w-3xl mx-auto">
                                    <button
                                        onClick={() => startGame('practice')}
                                        className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-6 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
                                        üìö {TRANSLATIONS.practiceMode}
                                        <div className="text-sm mt-2 opacity-90">
                                            √ìt√≠matakm√∂rku√∞ ‚Ä¢ √ìtakmarka√∞ar v√≠sbendingar
                                        </div>
                                    </button>

                                    <button
                                        onClick={() => startGame('challenge')}
                                        className="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold py-6 px-8 rounded-xl text-xl transition-all transform hover:scale-105">
                                        üèÜ {TRANSLATIONS.challengeMode}
                                        <div className="text-sm mt-2 opacity-90">
                                            T√≠ma√ær√Ωstingur ‚Ä¢ Stigat√∂flur ‚Ä¢ Raunir
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // ============================================
            // RENDER: Playing Screen
            // ============================================
            
            if (gameState.screen === 'playing') {
                return (
                    <div>
                        {/* Header with Stats */}
                        <header className="site-header">
                            <div className="header-content">
                                <a href="https://kvenno.app" className="site-logo">Kvenno.app</a>
                                <div className="flex items-center gap-4">
                                    {gameState.mode === 'challenge' && (
                                        <>
                                            <div className="text-sm">
                                                <span className="font-bold">{TRANSLATIONS.score}:</span> {gameState.score}
                                            </div>
                                            <div className="text-sm">
                                                <span className="font-bold">{TRANSLATIONS.streak}:</span> {gameState.streak} üî•
                                            </div>
                                            <div className="text-sm">
                                                <span className="font-bold">{TRANSLATIONS.time}:</span> {gameState.timeRemaining}s
                                            </div>
                                        </>
                                    )}
                                </div>
                            </div>
                        </header>

                        {/* Main Game Area */}
                        <div className="max-w-6xl mx-auto px-4 py-8">
                            <div className="grid md:grid-cols-2 gap-6">
                                {/* Left: Particle Animation */}
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    <h3 className="text-lg font-bold text-gray-800 mb-4 text-center">
                                        Agnahreyfing / Particle Motion
                                    </h3>
                                    <canvas 
                                        ref={canvasRef}
                                        id="gasCanvas"
                                        width="400"
                                        height="400"
                                        className="w-full pressure-normal"
                                    />
                                </div>

                                {/* Right: Problem & Input */}
                                <div className="bg-white rounded-2xl shadow-xl p-6">
                                    {/* Scenario Card */}
                                    <div className="bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl p-6 mb-6">
                                        <div className="text-4xl mb-2 text-center">
                                            {gameState.currentQuestion?.scenario.icon}
                                        </div>
                                        <h2 className="text-2xl font-bold text-center mb-2">
                                            {gameState.currentQuestion?.scenario.title}
                                        </h2>
                                        <p className="text-center opacity-90">
                                            {gameState.currentQuestion?.scenario.description}
                                        </p>
                                    </div>

                                    {/* Problem Setup */}
                                    <div className="bg-gray-50 rounded-xl p-6 mb-6">
                                        <h3 className="font-bold text-gray-800 mb-4">Given:</h3>
                                        {/* TODO: Display known values */}
                                        
                                        <h3 className="font-bold text-gray-800 mt-4 mb-2">Find:</h3>
                                        {/* TODO: Show unknown variable */}
                                    </div>

                                    {/* Answer Input */}
                                    <div className="mb-6">
                                        <label className="block text-gray-700 font-bold mb-2">
                                            Your Answer:
                                        </label>
                                        <div className="flex gap-2">
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={gameState.userAnswer}
                                                onChange={(e) => setGameState(prev => ({
                                                    ...prev,
                                                    userAnswer: e.target.value
                                                }))}
                                                className="flex-1 border-2 border-gray-300 rounded-lg px-4 py-3 text-lg"
                                                placeholder="0.00"
                                            />
                                            <span className="flex items-center px-4 bg-gray-100 rounded-lg font-bold">
                                                {/* TODO: Show unit */}
                                                L
                                            </span>
                                        </div>
                                    </div>

                                    {/* Action Buttons */}
                                    <div className="flex gap-4">
                                        <button
                                            onClick={checkAnswer}
                                            className="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 rounded-xl transition-colors text-xl">
                                            {TRANSLATIONS.checkAnswer} ‚úì
                                        </button>
                                        
                                        <button
                                            onClick={showHint}
                                            className="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-4 px-6 rounded-xl transition-colors">
                                            üí° {TRANSLATIONS.hint}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // TODO: Add Results Screen
            return null;
        };

        // ============================================
        // RENDER APP
        // ============================================
        
        ReactDOM.render(<GasLawChallenge />, document.getElementById('root'));
    </script>
</body>
</html>
