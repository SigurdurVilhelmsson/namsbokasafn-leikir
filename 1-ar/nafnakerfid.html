<!DOCTYPE html>
<html lang="is">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nafnap√∂r - Kvenno Efnafr√¶√∞i</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --kvenno-orange: #f36b22;
            --kvenno-orange-dark: #d95a1a;
            --practice-green: #10b981;
            --practice-green-dark: #059669;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: #f9fafb;
        }

        .site-header {
            background: white;
            border-bottom: 2px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            height: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .site-logo {
            font-size: 1.25rem;
            font-weight: bold;
            color: var(--kvenno-orange);
            text-decoration: none;
        }

        .site-logo:hover {
            color: var(--kvenno-orange-dark);
        }

        .header-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0.5rem;
        }

        .header-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        .breadcrumb {
            color: #6b7280;
            font-size: 0.875rem;
            padding: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .breadcrumb a {
            color: var(--kvenno-orange);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .back-btn {
            background: white;
            border: 2px solid var(--kvenno-orange);
            color: var(--kvenno-orange);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 0.875rem;
            margin: 0 1rem 1rem 1rem;
        }

        .back-btn:hover {
            background: var(--kvenno-orange);
            color: white;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Card flip animation with 3D effect */
        .card {
            perspective: 1000px;
            transition: transform 0.3s ease;
        }

        .card:hover:not(:disabled) {
            transform: scale(1.05);
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-back {
            transform: rotateY(180deg);
        }

        /* Match success animation */
        @keyframes matchGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            50% { box-shadow: 0 0 20px 10px rgba(16, 185, 129, 0.3); }
        }

        .matched {
            animation: matchGlow 1s ease-in-out;
        }

        /* Wrong match shake animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Confetti animation */
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--kvenno-orange);
            animation: confetti-fall 3s linear forwards;
            pointer-events: none;
        }

        /* Mobile optimization - ensure cards are touch-friendly */
        @media (max-width: 640px) {
            .card {
                min-width: 60px;
                min-height: 60px;
            }
        }

        /* High contrast mode */
        .high-contrast {
            filter: contrast(1.5);
        }

        /* Accessibility - focus indicators */
        .card:focus {
            outline: 3px solid var(--kvenno-orange);
            outline-offset: 2px;
        }

        /* Popup animations */
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .popup {
            animation: slideIn 0.3s ease-out;
        }

        /* Streak fire effect */
        @keyframes fireFlicker {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .fire-icon {
            animation: fireFlicker 0.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <!-- Site Header -->
    <header class="site-header">
        <div class="header-content">
            <a href="/" class="site-logo">Kvenno Efnafr√¶√∞i</a>
            <div class="header-actions">
                <button class="header-btn" onclick="alert('Stj√≥rnendaa√∞gangur √≠ √ær√≥un')">Stj√≥rnandi</button>
                <button class="header-btn" onclick="alert('Hj√°lp og uppl√Ωsingar um leikina')">Uppl√Ωsingar</button>
            </div>
        </div>
    </header>

    <!-- Breadcrumbs -->
    <div class="breadcrumb">
        <a href="/">Heim</a> > <a href="/1-ar/">1. √°r</a> > <a href="/1-ar/games/">Leikir</a> > <span>Nafnap√∂r</span>
    </div>

    <!-- Back Button -->
    <div class="nav-container">
        <a href="/1-ar/games/" class="back-btn">
            <span>‚Üê</span>
            <span>Til baka</span>
        </a>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        /* ========================================
           COMPOUND DATA - ALL IN ICELANDIC
           NO ACIDS (students learn acids later)
           Appropriate for 1st year (ages 15-16)
           ======================================== */

        const compounds = [
            // AU√êVELT / EASY (10 compounds)
            { formula: 'NaCl', name: 'Natr√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Na', 'Cl'], info: 'M√°lmur + M√°lmleysingi ‚Üí J√≥nefni' },
            { formula: 'H‚ÇÇO', name: 'Vatn', type: 'molecular', category: 'sameindaefni', difficulty: 'easy',
              elements: ['H', 'O'], info: 'Eina efni√∞ me√∞ s√©rheiti!' },
            { formula: 'CO‚ÇÇ', name: 'Kold√≠ox√≠√∞', type: 'molecular', category: 'sameindaefni', difficulty: 'easy',
              elements: ['C', 'O'], info: 'Tv√≠efni: tv√¶r s√∫refniseiningar' },
            { formula: 'NH‚ÇÉ', name: 'Amm√≥n√≠ak', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['N', 'H'], info: 'Algengt efnasamband' },
            { formula: 'MgO', name: 'Magnes√≠umox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Mg', 'O'], info: 'M√°lmur + S√∫refni ‚Üí Ox√≠√∞' },
            { formula: 'CaCl‚ÇÇ', name: 'Kals√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Ca', 'Cl'], info: 'Ca¬≤‚Å∫ √æarf tv√∂ Cl‚Åª j√≥nir' },
            { formula: 'KBr', name: 'Kal√≠umbr√≥m√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['K', 'Br'], info: 'Endi -√≠√∞ fyrir tv√≠efni' },
            { formula: 'LiF', name: 'Lit√≠umfl√∫or√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Li', 'F'], info: 'Einfaldasta j√≥nefni√∞' },
            { formula: 'CH‚ÇÑ', name: 'Metan', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['C', 'H'], info: 'Einfaldasta kolvetni√∞' },
            { formula: 'O‚ÇÇ', name: 'S√∫refni', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['O'], info: 'Tv√≠at√≥ma sameind' },

            // AU√êVELT / EASY - ADDITIONS (9 more)
            { formula: 'N‚ÇÇ', name: 'Nitur', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['N'], info: 'Tv√≠at√≥ma sameind' },
            { formula: 'H‚ÇÇ', name: 'Vetni', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['H'], info: 'L√©ttasta frumefni√∞' },
            { formula: 'Cl‚ÇÇ', name: 'Kl√≥r', type: 'molecular', category: 'sameind', difficulty: 'easy',
              elements: ['Cl'], info: 'Gr√¶nt gas' },
            { formula: 'NaF', name: 'Natr√≠mfl√∫or√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Na', 'F'], info: 'Nota√∞ √≠ tannkremi' },
            { formula: 'KCl', name: 'Kal√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['K', 'Cl'], info: 'L√≠kt og bor√∞salt' },
            { formula: 'BaO', name: 'Bar√≠umox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Ba', 'O'], info: 'M√°lmox√≠√∞' },
            { formula: 'AlCl‚ÇÉ', name: '√Ålkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Al', 'Cl'], info: '√Ål hefur +3 hle√∞slu' },
            { formula: 'Na‚ÇÇO', name: 'Natr√≠umox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Na', 'O'], info: 'Tv√∂ Na‚Å∫ fyrir hvert O¬≤‚Åª' },
            { formula: 'MgCl‚ÇÇ', name: 'Magnes√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'easy',
              elements: ['Mg', 'Cl'], info: 'Algengt salt' },

            // MI√êLUNGS / MEDIUM (10 compounds - NO ACIDS!)
            { formula: 'Al‚ÇÇO‚ÇÉ', name: '√Ålox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Al', 'O'], info: 'Tv√∂ √°l, √ærj√∫ s√∫refni' },
            { formula: 'Fe‚ÇÇO‚ÇÉ', name: 'J√°rn(III)ox√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'medium',
              elements: ['Fe', 'O'], info: 'J√°rn me√∞ +3 hle√∞slu - rust' },
            { formula: 'CuSO‚ÇÑ', name: 'Kopar(II)s√∫lfat', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'medium',
              elements: ['Cu', 'S', 'O'], info: 'Kopar + S√∫lfat (SO‚ÇÑ¬≤‚Åª)' },
            { formula: 'Na‚ÇÇCO‚ÇÉ', name: 'Natr√≠umkarb√≥nat', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Na', 'C', 'O'], info: 'Sameindaj√≥n: CO‚ÇÉ¬≤‚Åª (karb√≥nat)' },
            { formula: 'NH‚ÇÑCl', name: 'Amm√≥n√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['N', 'H', 'Cl'], info: 'Amm√≥n√≠um (NH‚ÇÑ‚Å∫) + Kl√≥r√≠√∞' },
            { formula: 'NaOH', name: 'Natr√≠mh√Ωdrox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Na', 'O', 'H'], info: 'Sterkt basi, h√Ωdrox√≠√∞ (OH‚Åª)' },
            { formula: 'Ca(OH)‚ÇÇ', name: 'Kals√≠umh√Ωdrox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Ca', 'O', 'H'], info: 'Ca¬≤‚Å∫ + tv√∂ OH‚Åª' },
            { formula: 'KNO‚ÇÉ', name: 'Kal√≠umn√≠trat', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['K', 'N', 'O'], info: 'Sameindaj√≥n: NO‚ÇÉ‚Åª (n√≠trat)' },
            { formula: 'N‚ÇÇO‚ÇÑ', name: 'D√≠niturtetrox√≠√∞', type: 'molecular', category: 'sameind', difficulty: 'medium',
              elements: ['N', 'O'], info: 'Tv√∂ k√∂fnunarefni, fj√∂gur s√∫refni' },
            { formula: 'SO‚ÇÇ', name: 'Brennisteinsd√≠ox√≠√∞', type: 'molecular', category: 'sameind', difficulty: 'medium',
              elements: ['S', 'O'], info: 'Mengun fr√° brennisteinsneitun' },

            // MI√êLUNGS / MEDIUM - ADDITIONS (7 more)
            { formula: 'K‚ÇÇSO‚ÇÑ', name: 'Kal√≠ums√∫lfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['K', 'S', 'O'], info: 'Tv√∂ kal√≠um + s√∫lfat' },
            { formula: 'ZnO', name: 'Sinkox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Zn', 'O'], info: 'Nota√∞ √≠ s√≥larv√∂rn' },
            { formula: 'Na‚ÇÇSO‚ÇÑ', name: 'Natr√≠‚Äãums√∫lfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Na', 'S', 'O'], info: 'Algengur √≠ s√°pu' },
            { formula: 'CaCO‚ÇÉ', name: 'Kals√≠umkarb√≥nat', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Ca', 'C', 'O'], info: 'Kalksteinn, skeljabrot' },
            { formula: 'AgCl', name: 'Silfurkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Ag', 'Cl'], info: 'Hv√≠tur √∫rfellingur' },
            { formula: 'ZnCl‚ÇÇ', name: 'Sinkkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Zn', 'Cl'], info: 'Sink + kl√≥r' },
            { formula: 'BaCl‚ÇÇ', name: 'Bar√≠umkl√≥r√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'medium',
              elements: ['Ba', 'Cl'], info: 'Bar√≠um + kl√≥r' },

            // ERFITT / HARD (12 compounds - NO ACIDS!)
            { formula: 'FeCl‚ÇÉ', name: 'J√°rn(III)kl√≥r√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Fe', 'Cl'], info: 'J√°rn me√∞ +3 hle√∞slu' },
            { formula: 'CuO', name: 'Kopar(II)ox√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Cu', 'O'], info: 'Kopar me√∞ +2 hle√∞slu' },
            { formula: '(NH‚ÇÑ)‚ÇÇSO‚ÇÑ', name: 'Amm√≥n√≠ums√∫lfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['N', 'H', 'S', 'O'], info: 'Tv√∂ amm√≥n√≠um + eitt s√∫lfat' },
            { formula: 'Ca‚ÇÉ(PO‚ÇÑ)‚ÇÇ', name: 'Kals√≠umfosfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Ca', 'P', 'O'], info: '3 kals√≠um + 2 fosfat (PO‚ÇÑ¬≥‚Åª)' },
            { formula: 'Mg(NO‚ÇÉ)‚ÇÇ', name: 'Magnes√≠umn√≠trat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Mg', 'N', 'O'], info: 'Mg¬≤‚Å∫ + tv√∂ n√≠trat' },
            { formula: 'Al(OH)‚ÇÉ', name: '√Ålh√Ωdrox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Al', 'O', 'H'], info: '√Ål + √ærj√∫ h√Ωdrox√≠√∞' },
            { formula: 'P‚ÇÇO‚ÇÖ', name: 'D√≠fosf√≥rpentox√≠√∞', type: 'molecular', category: 'sameind', difficulty: 'hard',
              elements: ['P', 'O'], info: 'Tv√∂ fosf√≥r, fimm s√∫refni' },
            { formula: 'N‚ÇÇO', name: 'D√≠niturm√≥nox√≠√∞', type: 'molecular', category: 'sameind', difficulty: 'hard',
              elements: ['N', 'O'], info: 'Hl√°turgas' },
            { formula: 'AgNO‚ÇÉ', name: 'Silfurn√≠trat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Ag', 'N', 'O'], info: 'Silfur + n√≠trat' },
            { formula: 'FeSO‚ÇÑ', name: 'J√°rn(II)s√∫lfat', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Fe', 'S', 'O'], info: 'J√°rn me√∞ +2 hle√∞slu + s√∫lfat' },
            { formula: 'NaHCO‚ÇÉ', name: 'Natr√≠‚Äãumvetniskarb√≥nat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Na', 'H', 'C', 'O'], info: 'Matars√≥di' },
            { formula: 'KOH', name: 'Kal√≠umh√Ωdrox√≠√∞', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['K', 'O', 'H'], info: 'Sterkt basi' },

            // ERFITT / HARD - ADDITIONS (7 more)
            { formula: 'Cu(NO‚ÇÉ)‚ÇÇ', name: 'Kopar(II)n√≠trat', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Cu', 'N', 'O'], info: 'Kopar(II) + tv√∂ n√≠trat' },
            { formula: 'Al‚ÇÇ(SO‚ÇÑ)‚ÇÉ', name: '√Åls√∫lfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Al', 'S', 'O'], info: 'Tv√∂ √°l + √ærj√∫ s√∫lfat' },
            { formula: 'Fe(OH)‚ÇÉ', name: 'J√°rn(III)h√Ωdrox√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Fe', 'O', 'H'], info: 'J√°rn(III) + √ærj√∫ h√Ωdrox√≠√∞' },
            { formula: 'Cr‚ÇÇO‚ÇÉ', name: 'Kr√≥m(III)ox√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Cr', 'O'], info: 'Tv√∂ kr√≥m + √ærj√∫ s√∫refni' },
            { formula: 'MnO‚ÇÇ', name: 'Mangan(IV)ox√≠√∞', type: 'ionic', category: 'm√°lmar-breytilega-hle√∞sla', difficulty: 'hard',
              elements: ['Mn', 'O'], info: 'Mangan me√∞ +4 hle√∞slu' },
            { formula: 'CaSO‚ÇÑ', name: 'Kals√≠ums√∫lfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Ca', 'S', 'O'], info: 'Gips' },
            { formula: 'Na‚ÇÉPO‚ÇÑ', name: 'Natr√≠‚Äãumfosfat', type: 'ionic', category: 'j√≥nefni', difficulty: 'hard',
              elements: ['Na', 'P', 'O'], info: '√ûrj√∫ natr√≠um + fosfat' }
        ];

        /* ========================================
           NOMENCLATURE RULES IN ICELANDIC
           ======================================== */

        const nomenclatureRules = {
            title: 'NAFNAREGLUR',
            sections: [
                {
                    title: 'Tv√≠efni (Binary compounds):',
                    rules: [
                        'M√°lmur + M√°lmleysingi ‚Üí [M√°lmur][M√°lmleysingi]-√≠√∞',
                        'D√¶mi: NaCl = Natr√≠um-kl√≥r√≠√∞',
                        'Endi -√≠√∞ er fyrir tv√≠efni'
                    ]
                },
                {
                    title: 'M√°lmar me√∞ breytilega hle√∞slu:',
                    rules: [
                        'Nota r√≥mverskar t√∂lur: (I), (II), (III), (IV)',
                        'D√¶mi: FeCl‚ÇÇ = J√°rn(II)kl√≥r√≠√∞',
                        '      FeCl‚ÇÉ = J√°rn(III)kl√≥r√≠√∞',
                        'Talan s√Ωnir hle√∞slu j√≥nsins'
                    ]
                },
                {
                    title: 'Sameindaj√≥nir (fj√∂lhla√∞a j√≥nir):',
                    rules: [
                        'S√∫lfat: SO‚ÇÑ¬≤‚Åª',
                        'N√≠trat: NO‚ÇÉ‚Åª',
                        'Karb√≥nat: CO‚ÇÉ¬≤‚Åª',
                        'Fosfat: PO‚ÇÑ¬≥‚Åª',
                        'H√Ωdrox√≠√∞: OH‚Åª',
                        'Amm√≥n√≠um: NH‚ÇÑ‚Å∫'
                    ]
                }
            ]
        };

        /* ========================================
           LEARNING TIPS BY DIFFICULTY
           ======================================== */

        const learningTips = {
            easy: [
                'Tv√≠efni enda √° -√≠√∞: kl√≥r√≠√∞, ox√≠√∞, br√≥m√≠√∞, fl√∫or√≠√∞',
                'Vatn (H‚ÇÇO) er eina efni√∞ me√∞ s√©rheiti!',
                'M√°lmur + M√°lmleysingi = J√≥nefni',
                'S√∫refnissamb√∂nd enda √° -ox√≠√∞',
                'Kl√≥rsamb√∂nd enda √° -kl√≥r√≠√∞'
            ],
            medium: [
                'Sameindaj√≥nir: s√∫lfat (SO‚ÇÑ¬≤‚Åª), n√≠trat (NO‚ÇÉ‚Åª), karb√≥nat (CO‚ÇÉ¬≤‚Åª)',
                'H√Ωdrox√≠√∞ (OH‚Åª) og amm√≥n√≠um (NH‚ÇÑ‚Å∫) eru algeng',
                'H√Ωdrox√≠√∞ endi t√°knar basa (ekki s√Ωrur)',
                'Sameindaj√≥nir hafa s√©rst√∂k n√∂fn sem √æarf a√∞ l√¶ra',
                'Tv√≠efni me√∞ tveimur m√°lmleysinga nota forskeyti'
            ],
            hard: [
                'R√≥mverskar t√∂lur: Fe(II) = +2 hle√∞sla, Fe(III) = +3 hle√∞sla',
                'Svigarnir margfalda: Ca‚ÇÉ(PO‚ÇÑ)‚ÇÇ = 3 Ca og 2 PO‚ÇÑ',
                'M√°lmar me√∞ breytilega hle√∞slu √æurfa r√≥mverskar t√∂lur',
                'Cu, Fe, Mn, Cr hafa oft breytilega hle√∞slu',
                'Sameindaj√≥n √≠ sviga √ó tala utan sviga = heildarfj√∂ldi'
            ]
        };

        /* ========================================
           ICON COMPONENTS
           ======================================== */

        const Clock = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Trophy = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const HelpCircle = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
        );

        const RotateCcw = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );

        const Lightbulb = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M9 18h6"></path>
                <path d="M10 22h4"></path>
                <path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"></path>
            </svg>
        );

        const Volume2 = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
                <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            </svg>
        );

        const VolumeX = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <line x1="23" y1="9" x2="17" y2="15"></line>
                <line x1="17" y1="9" x2="23" y2="15"></line>
            </svg>
        );

        const Book = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
        );

        const Eye = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );

        const Filter = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
            </svg>
        );

        /* ========================================
           UTILITY FUNCTIONS
           ======================================== */

        // LocalStorage helper with error handling
        const storage = {
            get: (key, defaultValue = null) => {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultValue;
                } catch (e) {
                    console.error('localStorage get error:', e);
                    return defaultValue;
                }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch (e) {
                    console.error('localStorage set error:', e);
                }
            }
        };

        // Sound effects (using Web Audio API for simple beeps)
        const playSound = (type, isMuted) => {
            if (isMuted) return;

            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                const sounds = {
                    flip: { freq: 400, duration: 0.1 },
                    match: { freq: 600, duration: 0.2 },
                    mismatch: { freq: 200, duration: 0.15 },
                    complete: { freq: 800, duration: 0.3 },
                    streak: { freq: 700, duration: 0.15 }
                };

                const sound = sounds[type] || sounds.flip;
                oscillator.frequency.value = sound.freq;
                gainNode.gain.value = 0.1;

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + sound.duration);
            } catch (e) {
                // Silently fail if audio not supported
            }
        };

        // Confetti animation
        const createConfetti = () => {
            const colors = ['#f36b22', '#10b981', '#3b82f6', '#f59e0b', '#8b5cf6'];
            const confettiCount = 50;

            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                document.body.appendChild(confetti);

                setTimeout(() => confetti.remove(), 3000);
            }
        };

        /* ========================================
           MAIN GAME COMPONENT
           ======================================== */

        const NafnaparGame = () => {
            // Game state
            const [gameState, setGameState] = useState({
                cards: [],
                flippedCards: [],
                matchedPairs: 0,
                moves: 0,
                timeElapsed: 0,
                isPlaying: false,
                gameOver: false,
                difficulty: 'easy',
                score: 0,
                streak: 0,
                maxStreak: 0,
                isPracticeMode: false,
                timerMode: 'normal', // 'untimed', 'normal', 'challenge'
                hintsUsed: 0,
                categoryFilter: 'all' // 'all', 'j√≥nefni', 'sameind', 'm√°lmar-breytilega-hle√∞sla'
            });

            // UI state
            const [showInstructions, setShowInstructions] = useState(true);
            const [showRules, setShowRules] = useState(false);
            const [showProgress, setShowProgress] = useState(false);
            const [showStudyMode, setShowStudyMode] = useState(false);
            const [isMuted, setIsMuted] = useState(false);
            const [isHighContrast, setIsHighContrast] = useState(false);
            const [matchPopup, setMatchPopup] = useState(null);
            const [mismatchPopup, setMismatchPopup] = useState(null);
            const [selectedCard, setSelectedCard] = useState(null);
            const [showSettings, setShowSettings] = useState(false);

            const timerRef = useRef(null);
            const cardRefs = useRef([]);

            /* ========================================
               GAME LOGIC
               ======================================== */

            const generateCards = (difficulty, pairCount, categoryFilter = 'all') => {
                let availableCompounds = compounds.filter(c => c.difficulty === difficulty);

                // Apply category filter if specified
                if (categoryFilter !== 'all') {
                    availableCompounds = availableCompounds.filter(c => c.category === categoryFilter);
                }

                const selectedCompounds = availableCompounds
                    .sort(() => Math.random() - 0.5)
                    .slice(0, Math.min(pairCount, availableCompounds.length));

                const cards = [];
                selectedCompounds.forEach((compound, index) => {
                    cards.push({
                        id: `${compound.formula}-formula-${index}`,
                        content: compound.formula,
                        type: 'formula',
                        compoundId: compound.formula,
                        compound: compound,
                        isFlipped: false,
                        isMatched: false,
                        tabIndex: index * 2
                    });
                    cards.push({
                        id: `${compound.formula}-name-${index}`,
                        content: compound.name,
                        type: 'name',
                        compoundId: compound.formula,
                        compound: compound,
                        isFlipped: false,
                        isMatched: false,
                        tabIndex: index * 2 + 1
                    });
                });

                return cards.sort(() => Math.random() - 0.5);
            };

            const startGame = (difficulty, isPracticeMode = false, categoryFilter = 'all') => {
                const pairCount = difficulty === 'easy' ? 6 : difficulty === 'medium' ? 8 : 10;
                const cards = generateCards(difficulty, pairCount, categoryFilter);

                setGameState({
                    cards,
                    flippedCards: [],
                    matchedPairs: 0,
                    moves: 0,
                    timeElapsed: 0,
                    isPlaying: true,
                    gameOver: false,
                    difficulty,
                    score: 0,
                    streak: 0,
                    maxStreak: 0,
                    isPracticeMode,
                    timerMode: isPracticeMode ? 'untimed' : 'normal',
                    hintsUsed: 0,
                    categoryFilter
                });

                setShowInstructions(false);
                setShowStudyMode(false);
            };

            const handleCardClick = (clickedCard) => {
                if (!gameState.isPlaying || gameState.flippedCards.length === 2 ||
                    clickedCard.isFlipped || clickedCard.isMatched) {
                    return;
                }

                playSound('flip', isMuted);

                const newFlippedCards = [...gameState.flippedCards, clickedCard];

                setGameState(prev => ({
                    ...prev,
                    cards: prev.cards.map(card =>
                        card.id === clickedCard.id ? { ...card, isFlipped: true } : card
                    ),
                    flippedCards: newFlippedCards
                }));

                if (newFlippedCards.length === 2) {
                    setGameState(prev => ({ ...prev, moves: prev.moves + 1 }));

                    const [first, second] = newFlippedCards;
                    const isMatch = first.compoundId === second.compoundId && first.type !== second.type;

                    if (isMatch) {
                        // Match found!
                        playSound('match', isMuted);

                        setTimeout(() => {
                            setGameState(prev => {
                                const newMatchedPairs = prev.matchedPairs + 1;
                                const totalPairs = prev.cards.length / 2;
                                const isGameOver = newMatchedPairs === totalPairs;

                                const newStreak = prev.streak + 1;
                                const newMaxStreak = Math.max(newStreak, prev.maxStreak);

                                // Streak bonus
                                const streakBonus = newStreak > 3 ? (newStreak - 3) * 5 : 0;

                                // Calculate score
                                const baseScore = prev.difficulty === 'easy' ? 100 :
                                                prev.difficulty === 'medium' ? 150 : 200;
                                const timeBonus = prev.timerMode !== 'untimed' ? Math.max(0, 300 - prev.timeElapsed) : 0;
                                const moveBonus = Math.max(0, (totalPairs * 2 - prev.moves) * 10);
                                const hintPenalty = prev.hintsUsed * 10;
                                const totalScore = isGameOver ?
                                    baseScore + timeBonus + moveBonus - hintPenalty + streakBonus :
                                    prev.score + streakBonus;

                                // Show educational popup
                                const compound = first.compound;
                                setMatchPopup({
                                    formula: compound.formula,
                                    name: compound.name,
                                    info: compound.info,
                                    category: compound.category
                                });

                                // Track mastery
                                if (!prev.isPracticeMode) {
                                    const progress = storage.get('nafnapar-progress', {
                                        gamesPlayed: 0,
                                        bestTime: {},
                                        bestMoves: {},
                                        bestScore: {},
                                        compoundsMastered: [],
                                        byCategory: {}
                                    });

                                    if (!progress.compoundsMastered.includes(compound.formula)) {
                                        progress.compoundsMastered.push(compound.formula);
                                        storage.set('nafnapar-progress', progress);
                                    }
                                }

                                if (isGameOver) {
                                    playSound('complete', isMuted);
                                    createConfetti();

                                    // Update progress
                                    const progress = storage.get('nafnapar-progress', {
                                        gamesPlayed: 0,
                                        bestTime: {},
                                        bestMoves: {},
                                        bestScore: {},
                                        compoundsMastered: [],
                                        byCategory: {}
                                    });

                                    progress.gamesPlayed++;

                                    if (!progress.bestTime[prev.difficulty] || prev.timeElapsed < progress.bestTime[prev.difficulty]) {
                                        progress.bestTime[prev.difficulty] = prev.timeElapsed;
                                    }
                                    if (!progress.bestMoves[prev.difficulty] || prev.moves < progress.bestMoves[prev.difficulty]) {
                                        progress.bestMoves[prev.difficulty] = prev.moves;
                                    }
                                    if (!progress.bestScore[prev.difficulty] || totalScore > progress.bestScore[prev.difficulty]) {
                                        progress.bestScore[prev.difficulty] = totalScore;
                                    }

                                    storage.set('nafnapar-progress', progress);
                                }

                                return {
                                    ...prev,
                                    cards: prev.cards.map(card =>
                                        card.compoundId === first.compoundId ? { ...card, isMatched: true } : card
                                    ),
                                    flippedCards: [],
                                    matchedPairs: newMatchedPairs,
                                    gameOver: isGameOver,
                                    isPlaying: !isGameOver,
                                    score: totalScore,
                                    streak: newStreak,
                                    maxStreak: newMaxStreak
                                };
                            });
                        }, 500);

                        // Auto-hide popup after 2 seconds
                        setTimeout(() => setMatchPopup(null), 2000);
                    } else {
                        // No match
                        playSound('mismatch', isMuted);

                        // Show educational feedback
                        setMismatchPopup({
                            first: first.compound,
                            second: second.compound
                        });

                        setTimeout(() => {
                            setGameState(prev => ({
                                ...prev,
                                cards: prev.cards.map(card =>
                                    card.id === first.id || card.id === second.id
                                        ? { ...card, isFlipped: false }
                                        : card
                                ),
                                flippedCards: [],
                                streak: 0 // Reset streak on mismatch
                            }));
                            setMismatchPopup(null);
                        }, 1000);
                    }
                }
            };

            const useHint = (level) => {
                if (gameState.isPracticeMode || gameState.flippedCards.length > 0) return;

                const unmatched = gameState.cards.filter(c => !c.isMatched && !c.isFlipped);
                if (unmatched.length === 0) return;

                const randomCard = unmatched[Math.floor(Math.random() * unmatched.length)];

                if (level === 1) {
                    // Show category
                    alert(`V√≠sbending: √ûetta er ${randomCard.compound.category === 'j√≥nefni' ? 'j√≥nefni' :
                           randomCard.compound.category === 'sameind' ? 'sameind' :
                           'm√°lmur me√∞ breytilega hle√∞slu'}`);
                } else if (level === 2) {
                    // Show one element
                    const element = randomCard.compound.elements[0];
                    alert(`V√≠sbending: Inniheldur ${element}`);
                } else if (level === 3) {
                    // Reveal pair briefly
                    const pair = gameState.cards.filter(c => c.compoundId === randomCard.compoundId);
                    setGameState(prev => ({
                        ...prev,
                        cards: prev.cards.map(card =>
                            pair.some(p => p.id === card.id) ? { ...card, isFlipped: true } : card
                        )
                    }));

                    setTimeout(() => {
                        setGameState(prev => ({
                            ...prev,
                            cards: prev.cards.map(card =>
                                pair.some(p => p.id === card.id) && !card.isMatched
                                    ? { ...card, isFlipped: false } : card
                            )
                        }));
                    }, 1000);
                }

                const penalty = level === 1 ? 5 : level === 2 ? 10 : 15;
                setGameState(prev => ({
                    ...prev,
                    hintsUsed: prev.hintsUsed + 1,
                    score: Math.max(0, prev.score - penalty)
                }));

                playSound('streak', isMuted);
            };

            const resetGame = () => {
                if (timerRef.current) clearInterval(timerRef.current);
                setGameState(prev => ({
                    ...prev,
                    cards: [],
                    flippedCards: [],
                    matchedPairs: 0,
                    moves: 0,
                    timeElapsed: 0,
                    isPlaying: false,
                    gameOver: false,
                    score: 0,
                    streak: 0,
                    hintsUsed: 0
                }));
                setMatchPopup(null);
                setMismatchPopup(null);
            };

            /* ========================================
               TIMER EFFECT
               ======================================== */

            useEffect(() => {
                if (gameState.isPlaying && gameState.timerMode !== 'untimed') {
                    timerRef.current = setInterval(() => {
                        setGameState(prev => {
                            const newTime = prev.timeElapsed + 1;

                            // Challenge mode: end game after 3 minutes
                            if (prev.timerMode === 'challenge' && newTime >= 180) {
                                clearInterval(timerRef.current);
                                return { ...prev, gameOver: true, isPlaying: false };
                            }

                            return { ...prev, timeElapsed: newTime };
                        });
                    }, 1000);
                }

                return () => {
                    if (timerRef.current) clearInterval(timerRef.current);
                };
            }, [gameState.isPlaying, gameState.timerMode]);

            /* ========================================
               KEYBOARD SHORTCUTS
               ======================================== */

            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (!gameState.isPlaying) return;

                    // R: Reset game
                    if (e.key === 'r' || e.key === 'R') {
                        resetGame();
                    }

                    // H: Toggle help/rules
                    if (e.key === 'h' || e.key === 'H') {
                        setShowRules(prev => !prev);
                    }

                    // Numbers 1-9: Quick select card
                    if (e.key >= '1' && e.key <= '9') {
                        const index = parseInt(e.key) - 1;
                        if (index < gameState.cards.length) {
                            const card = gameState.cards[index];
                            if (!card.isFlipped && !card.isMatched) {
                                handleCardClick(card);
                            }
                        }
                    }
                };

                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, [gameState]);

            /* ========================================
               UTILITY FUNCTIONS
               ======================================== */

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            };

            const getDifficultyLabel = (diff) => {
                return diff === 'easy' ? 'Au√∞velt' : diff === 'medium' ? 'Mi√∞lungs' : 'Erfitt';
            };

            /* ========================================
               RENDER: INSTRUCTIONS SCREEN
               ======================================== */

            if (showInstructions) {
                return (
                    <div className={`min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4 md:p-8 ${isHighContrast ? 'high-contrast' : ''}`}>
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8">
                            <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-green-600">
                                üß™ Nafnap√∂r
                            </h1>

                            <div className="space-y-4 text-gray-700">
                                <h2 className="text-2xl font-semibold text-green-500">Lei√∞beiningar</h2>

                                <div className="bg-green-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">Markmi√∞:</h3>
                                    <p>Para saman efnaform√∫lur og n√∂fn efnasambanda!</p>
                                </div>

                                <div className="bg-blue-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">Hvernig √° a√∞ spila:</h3>
                                    <ol className="list-decimal list-inside space-y-2">
                                        <li>Veldu erfi√∞leikastig og stillingu</li>
                                        <li>Smelltu √° tv√∂ spj√∂ld til a√∞ sn√∫a √æeim vi√∞</li>
                                        <li>Ef √æau passa saman, haldast √æau opin</li>
                                        <li>Ef ekki, sn√∫ast √æau aftur</li>
                                        <li>Finndu √∂ll p√∂rin!</li>
                                    </ol>
                                </div>

                                <div className="bg-yellow-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">Erfi√∞leikastig:</h3>
                                    <ul className="space-y-2">
                                        <li><strong>Au√∞velt:</strong> 6 p√∂r - Algeng efnasamb√∂nd (NaCl, H‚ÇÇO, CO‚ÇÇ)</li>
                                        <li><strong>Mi√∞lungs:</strong> 8 p√∂r - Sameindaj√≥nir (CuSO‚ÇÑ, NH‚ÇÑCl)</li>
                                        <li><strong>Erfitt:</strong> 10 p√∂r - R√≥mversk t√∂lustafi, fl√≥kin n√∂fn</li>
                                    </ul>
                                </div>

                                <div className="bg-purple-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">Stillingar:</h3>
                                    <ul className="space-y-1">
                                        <li><strong>√Üfingastilling:</strong> Engin t√≠mam√∂rk, v√≠sbendingar, engin √ær√Ωstingur</li>
                                        <li><strong>Keppnisstilling:</strong> T√≠mi, stig, v√≠sbendingarkerfi me√∞ fr√°dr√¶tti</li>
                                    </ul>
                                </div>

                                <div className="bg-pink-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">√Åbendingar:</h3>
                                    <ul className="list-disc list-inside space-y-1 text-sm">
                                        <li>Mundu sta√∞setningu spjalda</li>
                                        <li>Byrja√∞u √° au√∞veldu stigi til a√∞ √¶fa</li>
                                        <li>R√≥mverskar t√∂lur (II, III) t√°kna hle√∞slu m√°lms</li>
                                        <li>Sameindaj√≥nir: SO‚ÇÑ¬≤‚Åª (s√∫lfat), NO‚ÇÉ‚Åª (n√≠trat)</li>
                                    </ul>
                                </div>

                                <div className="bg-orange-50 p-4 rounded-lg">
                                    <h3 className="font-semibold mb-2">Fl√Ωtilyklar:</h3>
                                    <ul className="list-disc list-inside space-y-1 text-sm">
                                        <li><kbd className="px-2 py-1 bg-gray-200 rounded">Tab</kbd> Fara √° milli spjalda</li>
                                        <li><kbd className="px-2 py-1 bg-gray-200 rounded">Enter</kbd> Sn√∫a spjaldi</li>
                                        <li><kbd className="px-2 py-1 bg-gray-200 rounded">R</kbd> Byrja upp √° n√Ωtt</li>
                                        <li><kbd className="px-2 py-1 bg-gray-200 rounded">H</kbd> S√Ωna/fela nafnareglur</li>
                                        <li><kbd className="px-2 py-1 bg-gray-200 rounded">1-9</kbd> Velja spjald hratt</li>
                                    </ul>
                                </div>
                            </div>

                            <div className="mt-6 space-y-3">
                                <button
                                    onClick={() => setShowInstructions(false)}
                                    className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl transition-colors duration-200 text-lg"
                                >
                                    Byrja a√∞ spila üöÄ
                                </button>

                                <button
                                    onClick={() => setShowProgress(true)}
                                    className="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-xl transition-colors"
                                >
                                    üìä Sko√∞a √ær√≥un
                                </button>

                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setIsMuted(!isMuted)}
                                        className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-colors flex items-center justify-center gap-2"
                                    >
                                        {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}
                                        {isMuted ? 'Hlj√≥√∞ af' : 'Hlj√≥√∞ √°'}
                                    </button>

                                    <button
                                        onClick={() => setIsHighContrast(!isHighContrast)}
                                        className="flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-colors"
                                    >
                                        {isHighContrast ? 'üîÜ Venjulegur' : 'üîÖ H√° birtuskil'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            /* ========================================
               RENDER: PROGRESS SCREEN
               ======================================== */

            if (showProgress) {
                const progress = storage.get('nafnapar-progress', {
                    gamesPlayed: 0,
                    bestTime: {},
                    bestMoves: {},
                    bestScore: {},
                    compoundsMastered: [],
                    byCategory: {}
                });

                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4 md:p-8">
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8">
                            <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-green-600">
                                üìä √û√≠n √ær√≥un
                            </h1>

                            <div className="space-y-4">
                                <div className="bg-blue-50 p-4 rounded-xl text-center">
                                    <div className="text-4xl font-bold text-blue-600">{progress.gamesPlayed}</div>
                                    <div className="text-sm text-gray-700">Leikir spila√∞ir</div>
                                </div>

                                <div className="bg-green-50 p-4 rounded-xl text-center">
                                    <div className="text-4xl font-bold text-green-600">{progress.compoundsMastered.length}</div>
                                    <div className="text-sm text-gray-700">Efni sem √æ√∫ hefur n√°√∞</div>
                                </div>

                                <h3 className="font-semibold text-lg mt-6">Bestu √°rangur:</h3>

                                {['easy', 'medium', 'hard'].map(diff => (
                                    <div key={diff} className="bg-gray-50 p-4 rounded-xl">
                                        <h4 className="font-semibold mb-2">{getDifficultyLabel(diff)}</h4>
                                        <div className="grid grid-cols-3 gap-2 text-sm">
                                            <div className="text-center">
                                                <div className="font-bold text-blue-600">
                                                    {progress.bestTime[diff] ? formatTime(progress.bestTime[diff]) : '-'}
                                                </div>
                                                <div className="text-xs text-gray-600">T√≠mi</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="font-bold text-green-600">
                                                    {progress.bestMoves[diff] || '-'}
                                                </div>
                                                <div className="text-xs text-gray-600">Fer√∞ir</div>
                                            </div>
                                            <div className="text-center">
                                                <div className="font-bold text-purple-600">
                                                    {progress.bestScore[diff] || '-'}
                                                </div>
                                                <div className="text-xs text-gray-600">Stig</div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            <button
                                onClick={() => setShowProgress(false)}
                                className="w-full mt-6 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-xl transition-colors"
                            >
                                Til baka
                            </button>
                        </div>
                    </div>
                );
            }

            /* ========================================
               RENDER: STUDY MODE
               ======================================== */

            if (showStudyMode) {
                const studyCompounds = compounds.filter(c => c.difficulty === gameState.difficulty);

                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4 md:p-8">
                        <div className="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8">
                            <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-green-600">
                                üìö Sko√∞a √∂ll efni - {getDifficultyLabel(gameState.difficulty)}
                            </h1>

                            <div className="grid md:grid-cols-2 gap-4 mb-6">
                                {studyCompounds.map(compound => (
                                    <div key={compound.formula} className="bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-xl">
                                        <div className="text-2xl font-bold text-blue-600 mb-1">{compound.formula}</div>
                                        <div className="text-lg text-purple-600 mb-2">{compound.name}</div>
                                        <div className="text-sm text-gray-600 italic">{compound.info}</div>
                                    </div>
                                ))}
                            </div>

                            <button
                                onClick={() => {
                                    setShowStudyMode(false);
                                    startGame(gameState.difficulty, gameState.isPracticeMode, gameState.categoryFilter);
                                }}
                                className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl transition-colors"
                            >
                                Byrja leik! üöÄ
                            </button>
                        </div>
                    </div>
                );
            }

            /* ========================================
               RENDER: DIFFICULTY SELECTION
               ======================================== */

            if (!gameState.isPlaying && !gameState.gameOver) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4 md:p-8">
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8">
                            <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-green-600">
                                üß™ Nafnap√∂r
                            </h1>

                            <div className="space-y-6">
                                <div className="text-center">
                                    <p className="text-lg text-gray-700 mb-4">
                                        Veldu erfi√∞leikastig:
                                    </p>
                                </div>

                                {/* Mode Toggle */}
                                <div className="flex gap-3 mb-4">
                                    <button
                                        onClick={() => setGameState(prev => ({ ...prev, isPracticeMode: false }))}
                                        className={`flex-1 py-3 px-4 rounded-xl font-semibold transition-colors ${
                                            !gameState.isPracticeMode
                                                ? 'bg-blue-500 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        üèÜ Keppnisstilling
                                    </button>
                                    <button
                                        onClick={() => setGameState(prev => ({ ...prev, isPracticeMode: true }))}
                                        className={`flex-1 py-3 px-4 rounded-xl font-semibold transition-colors ${
                                            gameState.isPracticeMode
                                                ? 'bg-green-500 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        üìñ √Üfingastilling
                                    </button>
                                </div>

                                {/* Category Filter */}
                                <div className="bg-gray-50 p-4 rounded-xl">
                                    <label className="block text-sm font-semibold mb-2">üîç S√≠a eftir flokki (valfrj√°lst):</label>
                                    <select
                                        value={gameState.categoryFilter}
                                        onChange={(e) => setGameState(prev => ({ ...prev, categoryFilter: e.target.value }))}
                                        className="w-full p-2 border-2 border-gray-300 rounded-lg"
                                    >
                                        <option value="all">√ñll efni</option>
                                        <option value="j√≥nefni">J√≥nefni</option>
                                        <option value="sameind">Sameindir</option>
                                        <option value="m√°lmar-breytilega-hle√∞sla">M√°lmar me√∞ breytilega hle√∞slu</option>
                                    </select>
                                </div>

                                {/* Difficulty Buttons */}
                                <div className="grid gap-4">
                                    <button
                                        onClick={() => {
                                            setGameState(prev => ({ ...prev, difficulty: 'easy' }));
                                            setShowStudyMode(true);
                                        }}
                                        className="bg-green-500 hover:bg-green-600 text-white font-bold py-6 px-6 rounded-xl transition-colors"
                                    >
                                        <div className="text-2xl mb-2">üòä</div>
                                        <div className="text-xl">Au√∞velt</div>
                                        <div className="text-sm opacity-90 mt-2">6 p√∂r - Algeng efnasamb√∂nd</div>
                                        <div className="text-xs opacity-80">NaCl, H‚ÇÇO, CO‚ÇÇ, MgO...</div>
                                    </button>

                                    <button
                                        onClick={() => {
                                            setGameState(prev => ({ ...prev, difficulty: 'medium' }));
                                            setShowStudyMode(true);
                                        }}
                                        className="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-6 px-6 rounded-xl transition-colors"
                                    >
                                        <div className="text-2xl mb-2">ü§î</div>
                                        <div className="text-xl">Mi√∞lungs</div>
                                        <div className="text-sm opacity-90 mt-2">8 p√∂r - Sameindaj√≥nir</div>
                                        <div className="text-xs opacity-80">CuSO‚ÇÑ, NH‚ÇÑCl, NaOH...</div>
                                    </button>

                                    <button
                                        onClick={() => {
                                            setGameState(prev => ({ ...prev, difficulty: 'hard' }));
                                            setShowStudyMode(true);
                                        }}
                                        className="bg-red-500 hover:bg-red-600 text-white font-bold py-6 px-6 rounded-xl transition-colors"
                                    >
                                        <div className="text-2xl mb-2">üò∞</div>
                                        <div className="text-xl">Erfitt</div>
                                        <div className="text-sm opacity-90 mt-2">10 p√∂r - Fl√≥kin efnasamb√∂nd</div>
                                        <div className="text-xs opacity-80">Fe‚ÇÇO‚ÇÉ, (NH‚ÇÑ)‚ÇÇSO‚ÇÑ, Ca‚ÇÉ(PO‚ÇÑ)‚ÇÇ...</div>
                                    </button>
                                </div>

                                <button
                                    onClick={() => setShowInstructions(true)}
                                    className="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-colors"
                                >
                                    üìñ Sj√° lei√∞beiningar
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            /* ========================================
               RENDER: GAME OVER
               ======================================== */

            if (gameState.gameOver) {
                const efficiency = ((gameState.cards.length / 2) * 2 / gameState.moves * 100).toFixed(0);
                const randomTip = learningTips[gameState.difficulty][Math.floor(Math.random() * learningTips[gameState.difficulty].length)];

                return (
                    <div className="min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4 md:p-8">
                        <div className="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-8">
                            <h1 className="text-3xl md:text-4xl font-bold text-center mb-6 text-green-600">
                                üéâ Til hamingju!
                            </h1>

                            <div className="space-y-6">
                                {!gameState.isPracticeMode && (
                                    <div className="bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-xl">
                                        <div className="text-center">
                                            <div className="text-5xl md:text-6xl font-bold text-green-600 mb-2">
                                                {gameState.score}
                                            </div>
                                            <div className="text-xl text-gray-700">Heildarsta√∞a</div>
                                        </div>
                                    </div>
                                )}

                                <div className="grid grid-cols-2 gap-4">
                                    {gameState.timerMode !== 'untimed' && (
                                        <div className="bg-blue-50 p-4 rounded-xl text-center">
                                            <div className="text-2xl md:text-3xl font-bold text-blue-600">
                                                {formatTime(gameState.timeElapsed)}
                                            </div>
                                            <div className="text-sm text-gray-700">T√≠mi</div>
                                        </div>
                                    )}

                                    <div className="bg-green-50 p-4 rounded-xl text-center">
                                        <div className="text-2xl md:text-3xl font-bold text-green-600">
                                            {gameState.moves}
                                        </div>
                                        <div className="text-sm text-gray-700">Fer√∞ir</div>
                                    </div>

                                    <div className="bg-yellow-50 p-4 rounded-xl text-center">
                                        <div className="text-2xl md:text-3xl font-bold text-yellow-600">
                                            {efficiency}%
                                        </div>
                                        <div className="text-sm text-gray-700">Skilvirkni</div>
                                    </div>

                                    <div className="bg-purple-50 p-4 rounded-xl text-center">
                                        <div className="text-2xl md:text-3xl font-bold text-purple-600">
                                            {gameState.matchedPairs}
                                        </div>
                                        <div className="text-sm text-gray-700">P√∂r</div>
                                    </div>

                                    {gameState.maxStreak > 3 && (
                                        <div className="bg-orange-50 p-4 rounded-xl text-center col-span-2">
                                            <div className="text-2xl md:text-3xl font-bold text-orange-600">
                                                üî• {gameState.maxStreak} √≠ r√∂√∞!
                                            </div>
                                            <div className="text-sm text-gray-700">Lengsta runa</div>
                                        </div>
                                    )}
                                </div>

                                {!gameState.isPracticeMode && (
                                    <div className="bg-green-50 p-4 rounded-xl">
                                        <h3 className="font-semibold text-center mb-2">
                                            {gameState.score >= 400 ? 'üåü Fullkomi√∞!' :
                                            gameState.score >= 300 ? 'üëç Fr√°b√¶rt!' :
                                            gameState.score >= 200 ? 'üí™ Vel gert!' :
                                            'üìö G√≥√∞ byrjun!'}
                                        </h3>
                                        <p className="text-center text-sm text-gray-700">
                                            {gameState.score >= 400 ? '√û√∫ ert sannkalla√∞ur efnafr√¶√∞ingur!' :
                                            gameState.score >= 300 ? 'Mj√∂g gott minnisafk√∂st!' :
                                            gameState.score >= 200 ? 'Haltu √°fram a√∞ √¶fa!' :
                                            'Pr√≥fa√∞u aftur til a√∞ b√¶ta stigin!'}
                                        </p>
                                    </div>
                                )}

                                {/* Learning Tip */}
                                <div className="bg-blue-50 p-4 rounded-xl">
                                    <h3 className="font-semibold mb-2 flex items-center gap-2">
                                        <Lightbulb size={20} />
                                        √Åbending:
                                    </h3>
                                    <p className="text-sm text-gray-700">{randomTip}</p>
                                </div>

                                <div className="flex gap-4">
                                    <button
                                        onClick={resetGame}
                                        className="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-4 px-6 rounded-xl transition-colors flex items-center justify-center gap-2"
                                    >
                                        <RotateCcw size={20} />
                                        Velja anna√∞ stig
                                    </button>
                                    <button
                                        onClick={() => startGame(gameState.difficulty, gameState.isPracticeMode, gameState.categoryFilter)}
                                        className="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-xl transition-colors"
                                    >
                                        Spila aftur
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            /* ========================================
               RENDER: ACTIVE GAME
               ======================================== */

            return (
                <div className={`min-h-screen bg-gradient-to-br ${gameState.isPracticeMode ? 'from-green-50 to-emerald-100' : 'from-green-50 to-blue-100'} p-4 md:p-8 ${isHighContrast ? 'high-contrast' : ''}`}>
                    <div className="max-w-6xl mx-auto">
                        {/* Header with stats */}
                        <div className="bg-white rounded-2xl shadow-2xl p-4 md:p-6 mb-6">
                            <div className="flex justify-between items-center flex-wrap gap-4">
                                <div>
                                    <h1 className="text-xl md:text-3xl font-bold text-green-600">
                                        üß™ Nafnap√∂r
                                    </h1>
                                    <div className="text-sm text-gray-600">
                                        {getDifficultyLabel(gameState.difficulty)} - {gameState.isPracticeMode ? 'üìñ √Üfing' : 'üèÜ Keppni'}
                                    </div>
                                </div>

                                <div className="flex gap-4 items-center flex-wrap">
                                    {gameState.timerMode !== 'untimed' && (
                                        <div className="text-center">
                                            <div className="flex items-center gap-2 text-blue-600 mb-1">
                                                <Clock size={20} />
                                                <span className="text-xl md:text-2xl font-bold">
                                                    {formatTime(gameState.timeElapsed)}
                                                </span>
                                            </div>
                                            <div className="text-xs text-gray-600">T√≠mi</div>
                                        </div>
                                    )}

                                    <div className="text-center">
                                        <div className="text-xl md:text-2xl font-bold text-green-600">
                                            {gameState.moves}
                                        </div>
                                        <div className="text-xs text-gray-600">Fer√∞ir</div>
                                    </div>

                                    <div className="text-center">
                                        <div className="text-xl md:text-2xl font-bold text-purple-600">
                                            {gameState.matchedPairs}/{gameState.cards.length / 2}
                                        </div>
                                        <div className="text-xs text-gray-600">P√∂r</div>
                                    </div>

                                    {!gameState.isPracticeMode && (
                                        <div className="text-center">
                                            <div className="text-xl md:text-2xl font-bold text-orange-600">
                                                {gameState.score}
                                            </div>
                                            <div className="text-xs text-gray-600">Stig</div>
                                        </div>
                                    )}

                                    {gameState.streak > 0 && (
                                        <div className="text-center">
                                            <div className="text-xl md:text-2xl font-bold text-red-600 flex items-center gap-1">
                                                <span className="fire-icon">üî•</span>
                                                <span>{gameState.streak}</span>
                                            </div>
                                            <div className="text-xs text-gray-600">R√∂√∞</div>
                                        </div>
                                    )}
                                </div>

                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setShowRules(!showRules)}
                                        className="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"
                                        aria-label="S√Ωna nafnareglur"
                                    >
                                        <Book size={24} />
                                    </button>

                                    <button
                                        onClick={() => setIsMuted(!isMuted)}
                                        className="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"
                                        aria-label={isMuted ? 'Kveikja √° hlj√≥√∞i' : 'Sl√∂kkva √° hlj√≥√∞i'}
                                    >
                                        {isMuted ? <VolumeX size={24} /> : <Volume2 size={24} />}
                                    </button>

                                    <button
                                        onClick={() => setShowInstructions(true)}
                                        className="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors"
                                        aria-label="S√Ωna lei√∞beiningar"
                                    >
                                        <HelpCircle size={24} />
                                    </button>
                                </div>
                            </div>

                            {/* Streak Achievement */}
                            {gameState.streak === 5 && (
                                <div className="mt-4 bg-orange-100 border-2 border-orange-400 p-3 rounded-lg text-center animate-pulse">
                                    <span className="text-lg font-bold text-orange-700">üéâ 5 √≠ r√∂√∞! Fr√°b√¶rt! üéâ</span>
                                </div>
                            )}
                            {gameState.streak === 10 && (
                                <div className="mt-4 bg-red-100 border-2 border-red-400 p-3 rounded-lg text-center animate-pulse">
                                    <span className="text-lg font-bold text-red-700">üî• 10 √≠ r√∂√∞! Fullkominn! üî•</span>
                                </div>
                            )}
                        </div>

                        {/* Nomenclature Rules Card (collapsible) */}
                        {showRules && (
                            <div className="bg-white rounded-2xl shadow-2xl p-4 md:p-6 mb-6 popup">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl md:text-2xl font-bold text-green-600">
                                        {nomenclatureRules.title}
                                    </h2>
                                    <button
                                        onClick={() => setShowRules(false)}
                                        className="text-gray-500 hover:text-gray-700 text-2xl"
                                    >
                                        √ó
                                    </button>
                                </div>

                                <div className="space-y-4">
                                    {nomenclatureRules.sections.map((section, idx) => (
                                        <div key={idx} className="bg-gray-50 p-4 rounded-lg">
                                            <h3 className="font-semibold mb-2 text-gray-800">{section.title}</h3>
                                            <ul className="space-y-1 text-sm text-gray-700">
                                                {section.rules.map((rule, rIdx) => (
                                                    <li key={rIdx} className="ml-4">{rule}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Match Popup */}
                        {matchPopup && (
                            <div className="bg-white rounded-2xl shadow-2xl p-4 mb-6 border-4 border-green-400 popup">
                                <div className="flex justify-between items-start">
                                    <div className="flex-1">
                                        <div className="text-2xl font-bold text-green-600 mb-2">
                                            ‚úì {matchPopup.formula} = {matchPopup.name}
                                        </div>
                                        <div className="text-sm text-gray-700">{matchPopup.info}</div>
                                    </div>
                                    <button
                                        onClick={() => setMatchPopup(null)}
                                        className="text-gray-500 hover:text-gray-700 text-2xl ml-2"
                                    >
                                        √ó
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Mismatch Popup */}
                        {mismatchPopup && (
                            <div className="bg-white rounded-2xl shadow-2xl p-4 mb-6 border-4 border-red-400 popup shake">
                                <div className="text-xl font-bold text-red-600 mb-2">
                                    ‚ùå Ekki par
                                </div>
                                <div className="text-sm text-gray-700">
                                    {mismatchPopup.first.formula} er {mismatchPopup.first.name}
                                    <br />
                                    {mismatchPopup.second.formula} er {mismatchPopup.second.name}
                                </div>
                            </div>
                        )}

                        {/* Hint Buttons (Competition Mode Only) */}
                        {!gameState.isPracticeMode && (
                            <div className="bg-white rounded-2xl shadow-2xl p-4 mb-6">
                                <h3 className="font-semibold mb-3 flex items-center gap-2">
                                    <Lightbulb size={20} />
                                    V√≠sbendingar:
                                </h3>
                                <div className="grid grid-cols-3 gap-3">
                                    <button
                                        onClick={() => useHint(1)}
                                        disabled={gameState.flippedCards.length > 0}
                                        className="bg-yellow-100 hover:bg-yellow-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-yellow-800 font-semibold py-2 px-4 rounded-lg transition-colors text-sm"
                                    >
                                        V√≠sbending 1<br />
                                        <span className="text-xs">(-5 stig)</span>
                                    </button>
                                    <button
                                        onClick={() => useHint(2)}
                                        disabled={gameState.flippedCards.length > 0}
                                        className="bg-orange-100 hover:bg-orange-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-orange-800 font-semibold py-2 px-4 rounded-lg transition-colors text-sm"
                                    >
                                        V√≠sbending 2<br />
                                        <span className="text-xs">(-10 stig)</span>
                                    </button>
                                    <button
                                        onClick={() => useHint(3)}
                                        disabled={gameState.flippedCards.length > 0}
                                        className="bg-red-100 hover:bg-red-200 disabled:bg-gray-100 disabled:cursor-not-allowed text-red-800 font-semibold py-2 px-4 rounded-lg transition-colors text-sm"
                                    >
                                        V√≠sbending 3<br />
                                        <span className="text-xs">(-15 stig)</span>
                                    </button>
                                </div>
                            </div>
                        )}

                        {/* Game Board */}
                        <div className="bg-white rounded-2xl shadow-2xl p-4 md:p-6">
                            <div className={`grid gap-3 md:gap-4 ${
                                gameState.cards.length <= 12 ? 'grid-cols-3 md:grid-cols-4' :
                                gameState.cards.length <= 16 ? 'grid-cols-4 md:grid-cols-4' :
                                'grid-cols-4 md:grid-cols-5'
                            }`}
                            style={{ minHeight: '60px' }}
                            >
                                {gameState.cards.map((card, index) => (
                                    <button
                                        key={card.id}
                                        ref={el => cardRefs.current[index] = el}
                                        onClick={() => handleCardClick(card)}
                                        onKeyDown={(e) => {
                                            if (e.key === 'Enter' || e.key === ' ') {
                                                e.preventDefault();
                                                handleCardClick(card);
                                            }
                                        }}
                                        disabled={card.isFlipped || card.isMatched}
                                        tabIndex={card.isFlipped || card.isMatched ? -1 : 0}
                                        aria-label={`Spjald ${index + 1}, ${card.isMatched ? 'fundi√∞' : card.isFlipped ? card.content : 'fali√∞'}`}
                                        className={`card aspect-square rounded-xl font-bold text-xs md:text-base transition-all duration-300 ${
                                            card.isMatched
                                                ? 'bg-gradient-to-br from-green-400 to-green-600 text-white cursor-default matched'
                                                : card.isFlipped
                                                ? card.type === 'formula'
                                                    ? 'bg-gradient-to-br from-blue-400 to-blue-600 text-white'
                                                    : 'bg-gradient-to-br from-purple-400 to-purple-600 text-white'
                                                : 'bg-gradient-to-br from-gray-300 to-gray-400 hover:from-gray-400 hover:to-gray-500 text-transparent'
                                        }`}
                                        style={{ minWidth: '60px', minHeight: '60px' }}
                                    >
                                        <div className={`w-full h-full flex items-center justify-center p-2 ${
                                            card.isFlipped || card.isMatched ? '' : 'opacity-0'
                                        }`}>
                                            {card.isFlipped || card.isMatched ? (
                                                <span className="text-center leading-tight break-words">
                                                    {card.content}
                                                </span>
                                            ) : (
                                                '?'
                                            )}
                                        </div>
                                    </button>
                                ))}
                            </div>

                            <div className="mt-6 text-center">
                                <button
                                    onClick={resetGame}
                                    className="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-xl transition-colors flex items-center justify-center gap-2 mx-auto"
                                >
                                    <RotateCcw size={20} />
                                    Byrja upp √° n√Ωtt
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<NafnaparGame />, document.getElementById('root'));
    </script>
</body>
</html>
